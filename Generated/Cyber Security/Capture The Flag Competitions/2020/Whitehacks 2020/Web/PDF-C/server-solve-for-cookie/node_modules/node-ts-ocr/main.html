<h1>Node Typescript OCR</h1>
<p><a href="https://opensource.org/licenses/MIT"><img alt="License" src="https://img.shields.io/npm/l/make-coverage-badge.svg" /></a>
<a href="https://www.npmjs.com/package/node-ts-ocr"><img alt="Current Version" src="https://img.shields.io/npm/v/node-ts-ocr.svg" /></a>
<a href="https://www.npmjs.com/package/node-ts-ocr"><img alt="npm" src="https://img.shields.io/npm/dw/node-ts-ocr.svg" /></a>
<img alt="" src="https://img.shields.io/bundlephobia/min/node-ts-ocr.svg?style=flat" /></p>
<p>A simple wrapper around command-line utils to assist in PDF / Image OCR (Optical Character Recognition) processing using <a href="https://github.com/tesseract-ocr/tesseract">Tesseract</a>.</p>
<h2>Test Coverage</h2>
<p><img alt="Coverage lines" src="https://raw.githubusercontent.com/nicolaspearson/node.ts.ocr/master/coverage/badge-lines.svg?sanitize=true" />
<img alt="Coverage functions" src="https://raw.githubusercontent.com/nicolaspearson/node.ts.ocr/master/coverage/badge-functions.svg?sanitize=true" />
<img alt="Coverage branches" src="https://raw.githubusercontent.com/nicolaspearson/node.ts.ocr/master/coverage/badge-branches.svg?sanitize=true" />
<img alt="Coverage statements" src="https://raw.githubusercontent.com/nicolaspearson/node.ts.ocr/master/coverage/badge-statements.svg?sanitize=true" /></p>
<h2>Installation</h2>
<p><code>npm install node-ts-ocr --save</code></p>
<h2>Dependencies</h2>
<p>After installing node.ts.ocr, the following binaries need to be on your system, as well as in the paths in your environment settings.</p>
<h3>PDF To Text &amp; PDF Info</h3>
<p>Many PDF's already have plain text embedded in them, either because they were born-digital (i.e. created from a word processing document) or because OCR was already performed on them. If we are able to extract the text using this utility we do not need to perform image conversion and subsequently OCR.</p>
<p><strong>OSX</strong></p>
<p><code>pdftotext</code> &amp; <code>pdfinfo</code> are included as part of the <code>xpdf</code> utilities library.</p>
<p><code>bash
brew install xpdf</code></p>
<p><strong>Ubuntu</strong></p>
<p><code>pdftotext</code> &amp; <code>pdfinfo</code> are included in the <code>poppler-utils</code> library.</p>
<p><code>bash
sudo apt-get install poppler-utils</code></p>
<p><strong>CLI Example</strong></p>
<p>Attempt to extract the text from a PDF:</p>
<p><code>bash
pdftotext /path/to/document.pdf output.txt</code></p>
<h3>ImageMagick &amp; Ghostscript</h3>
<p>A PDF is a jumble of instructions for how to render a document on a screen or page. Although it may contain images, a PDF is not itself an image, and therefore we can't perform OCR on it directly. To convert PDF's to images, we use <a href="https://www.imagemagick.org/">ImageMagick's</a> convert function which depends on <a href="https://www.ghostscript.com/">Ghostscript</a>.</p>
<p><strong>OSX</strong></p>
<p><code>bash
brew install imagemagick
brew install gs</code></p>
<p><strong>Ubuntu</strong></p>
<p><code>bash
sudo apt-get update
sudo apt-get install imagemagick --fix-missing
sudo apt-get install ghostscript</code></p>
<p><strong>CLI Example</strong></p>
<p>Convert a PDF to a TIFF representation:</p>
<p><code>bash
convert -density 300 /path/to/document.pdf -depth 8 -strip -background white -alpha off image.tiff</code></p>
<h3>Tesseract</h3>
<p>Tesseract is Open Source OCR Engine.</p>
<p><strong>OSX</strong></p>
<p><code>bash
brew install tesseract</code></p>
<p><strong>Ubuntu</strong></p>
<p><code>bash
sudo apt-get install tesseract-ocr</code></p>
<p><strong>CLI Example</strong></p>
<p>Once we have a TIFF representation of the document, we can use Tesseract to (attempt to) extract the plain text:</p>
<p><code>bash
tesseract image.tiff output.txt</code></p>
<h2>Usage</h2>
<p>```typescript
import { Ocr } from 'node-ts-ocr';
import * as path from 'path';
import * as temp from 'temp';</p>
<p>export async function getPdfText(fileName: string): Promise<string> {
    // Assuming your file resides in a directory named sample
    const relativePath = path.join('sample', fileName);
    const filePath = path.join(__dirname, relativePath);
    // Extract the text and return the result
    return await Ocr.extractText(filePath);
}
```</p>
<h3>Methods</h3>
<p><strong><code>extractInfo(filePath: string)</code></strong></p>
<p>Retrieve the pdf info using the pdfinfo binary and parse the result to a key value object.</p>
<p><strong><code>extractText(filePath: string, options?: ExtractTextOptions)</code></strong></p>
<p>Extracts the text from the pdf using the pdftotext binary</p>
<p><strong><code>invokePdfToTiff(outDir: string, filePath: string, options?: ExtractTextOptions)</code></strong></p>
<p>Converts a PDF file to its TIFF representation using the convert binary</p>
<p><strong><code>invokeImageOcr(outDir: string, imagePath: string, options?: ExtractTextOptions)</code></strong></p>
<p>Performs OCR on an image in order to extract the text using the tesseract binary</p>
<h3>Options</h3>
<p><strong><code>ExtractTextOptions</code></strong></p>
<p>The arguments are key value pairs of valid command line arguments for the respective binary.</p>
<p><code>ExtractTextOptions {
  pdfToTextArgs?: KeyValue;
  convertArgs?: KeyValue;
  tesseractArgs?: KeyValue;
}</code></p>
<p>Example <code>pdfToTextArgs</code> that only includes page 1 to 4.</p>
<p>Note: this will only work if you already have a searchable PDF, because the <code>pdftotext</code> binary can only be used to extract text from a searchable PDF.</p>
<p><code>{ pdfToTextArgs: { f: 1, l: 4 } }</code></p>
<p>Example <code>convertArgs</code> that sets the convert density to 600, and the trim option to on.</p>
<p><code>{ convertArgs: { density: '600', trim: '' } }</code></p>
<p>Example <code>tesseractArgs</code> that sets the language to english, the page segmentation mode to 6, and preserves interword spaces.</p>
<p><code>{ tesseractArgs: { 'l': 'eng', '-psm': 6, 'c': 'preserve_interword_spaces=1' } }</code></p>
<h2>Docker</h2>
<p>Coming Soon...</p>