<h1>Description</h1>
<p>A very fast streaming multipart parser for node.js.</p>
<p>Benchmarks can be found <a href="https://github.com/mscdex/dicer/wiki/Benchmarks">here</a>.</p>
<h1>Requirements</h1>
<ul>
<li><a href="http://nodejs.org/">node.js</a> -- v0.8.0 or newer</li>
</ul>
<h1>Install</h1>
<pre><code>npm install dicer
</code></pre>
<h1>Examples</h1>
<ul>
<li>Parse an HTTP form upload</li>
</ul>
<p>```javascript
var inspect = require('util').inspect,
    http = require('http');</p>
<p>var Dicer = require('dicer');</p>
<pre><code>// quick and dirty way to parse multipart boundary
</code></pre>
<p>var RE_BOUNDARY = /^multipart\/.+?(?:; boundary=(?:(?:"(.+)")|(?:([^\s]+))))$/i,
    HTML = new Buffer('<html><head></head><body>\
                       <form method="POST" enctype="multipart/form-data">\
                         <input type="text" name="textfield"><br />\
                         <input type="file" name="filefield"><br />\
                         <input type="submit">\
                       </form>\
                       </body></html>'),
    PORT = 8080;</p>
<p>http.createServer(function(req, res) {
  var m;
  if (req.method === 'POST'
      &amp;&amp; req.headers['content-type']
      &amp;&amp; (m = RE_BOUNDARY.exec(req.headers['content-type']))) {
    var d = new Dicer({ boundary: m[1] || m[2] });</p>
<pre><code>d.on('part', function(p) {
  console.log('New part!');
  p.on('header', function(header) {
    for (var h in header) {
      console.log('Part header: k: ' + inspect(h)
                  + ', v: ' + inspect(header[h]));
    }
  });
  p.on('data', function(data) {
    console.log('Part data: ' + inspect(data.toString()));
  });
  p.on('end', function() {
    console.log('End of part\n');
  });
});
d.on('finish', function() {
  console.log('End of parts');
  res.writeHead(200);
  res.end('Form submission successful!');
});
req.pipe(d);
</code></pre>
<p>} else if (req.method === 'GET' &amp;&amp; req.url === '/') {
    res.writeHead(200);
    res.end(HTML);
  } else {
    res.writeHead(404);
    res.end();
  }
}).listen(PORT, function() {
  console.log('Listening for requests on port ' + PORT);
});
```</p>
<h1>API</h1>
<p><em>Dicer</em> is a <em>WritableStream</em></p>
<h2>Dicer (special) events</h2>
<ul>
<li>
<p><strong>finish</strong>() - Emitted when all parts have been parsed and the Dicer instance has been ended.</p>
</li>
<li>
<p><strong>part</strong>(&lt; <em>PartStream</em> &gt;stream) - Emitted when a new part has been found.</p>
</li>
<li>
<p><strong>preamble</strong>(&lt; <em>PartStream</em> &gt;stream) - Emitted for preamble if you should happen to need it (can usually be ignored).</p>
</li>
<li>
<p><strong>trailer</strong>(&lt; <em>Buffer</em> &gt;data) - Emitted when trailing data was found after the terminating boundary (as with the preamble, this can usually be ignored too).</p>
</li>
</ul>
<h2>Dicer methods</h2>
<ul>
<li>
<p><strong>(constructor)</strong>(&lt; <em>object</em> &gt;config) - Creates and returns a new Dicer instance with the following valid <code>config</code> settings:</p>
<ul>
<li>
<p><strong>boundary</strong> - <em>string</em> - This is the boundary used to detect the beginning of a new part.</p>
</li>
<li>
<p><strong>headerFirst</strong> - <em>boolean</em> - If true, preamble header parsing will be performed first.</p>
</li>
<li>
<p><strong>maxHeaderPairs</strong> - <em>integer</em> - The maximum number of header key=&gt;value pairs to parse <strong>Default:</strong> 2000 (same as node's http).</p>
</li>
</ul>
</li>
<li>
<p><strong>setBoundary</strong>(&lt; <em>string</em> &gt;boundary) - <em>(void)</em> - Sets the boundary to use for parsing and performs some initialization needed for parsing. You should only need to use this if you set <code>headerFirst</code> to true in the constructor and are parsing the boundary from the preamble header.</p>
</li>
</ul>
<p><em>PartStream</em> is a <em>ReadableStream</em></p>
<h2>PartStream (special) events</h2>
<ul>
<li><strong>header</strong>(&lt; <em>object</em> &gt;header) - An object containing the header for this particular part. Each property value is an <em>array</em> of one or more string values.</li>
</ul>