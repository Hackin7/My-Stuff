<h1>cookie-session</h1>
<p><a href="https://npmjs.org/package/cookie-session"><img alt="NPM Version" src="https://img.shields.io/npm/v/cookie-session.svg" /></a>
<a href="https://npmjs.org/package/cookie-session"><img alt="NPM Downloads" src="https://img.shields.io/npm/dm/cookie-session.svg" /></a>
<a href="https://travis-ci.org/expressjs/cookie-session"><img alt="Build Status" src="https://img.shields.io/travis/expressjs/cookie-session/master.svg" /></a>
<a href="https://coveralls.io/r/expressjs/cookie-session?branch=master"><img alt="Test Coverage" src="https://img.shields.io/coveralls/expressjs/cookie-session.svg" /></a></p>
<p>Simple cookie-based session middleware.</p>
<p>A user session can be stored in two main ways with cookies: on the server or on
the client. This module stores the session data on the client within a cookie,
while a module like <a href="https://www.npmjs.com/package/express-session">express-session</a>
stores only a session identifier on the client within a cookie and stores the
session data on the server, typically in a database.</p>
<p>The following points can help you choose which to use:</p>
<ul>
<li><code>cookie-session</code> does not require any database / resources on the server side,
    though the total session data cannot exceed the browser's max cookie size.</li>
<li><code>cookie-session</code> can simplify certain load-balanced scenarios.</li>
<li><code>cookie-session</code> can be used to store a "light" session and include an identifier
    to look up a database-backed secondary store to reduce database lookups.</li>
</ul>
<h2>Semantics</h2>
<p>This module provides "guest" sessions, meaning any visitor will have a session,
  authenticated or not. If a session is <em>new</em> a <code>Set-Cookie</code> will be produced regardless
  of populating the session.</p>
<h2>Install</h2>
<p><code>bash
$ npm install cookie-session</code></p>
<h2>API</h2>
<p><code>js
var cookieSession = require('cookie-session')</code></p>
<h3>cookieSession(options)</h3>
<p>Create a new cookie session middleware with the provided options.</p>
<h4>Options</h4>
<p>Cookie session accepts these properties in the options object.</p>
<h5>name</h5>
<p>The name of the cookie to set, defaults to <code>express:sess</code>.</p>
<h5>keys</h5>
<p>The list of keys to use to sign &amp; verify cookie values. Set cookies are always
signed with <code>keys[0]</code>, while the other keys are valid for verification, allowing
for key rotation.</p>
<h5>secret</h5>
<p>A string which will be used as single key if <code>keys</code> is not provided.</p>
<h5>Cookie Options</h5>
<p>Other options are passed to <code>cookies.get()</code> and <code>cookies.set()</code> allowing you
to control security, domain, path, and signing among other settings.</p>
<p>The options can also contain any of the following (for the full list, see
<a href="https://www.npmjs.org/package/cookies#readme">cookies module documentation</a>:</p>
<ul>
<li><code>maxAge</code>: a number representing the milliseconds from <code>Date.now()</code> for expiry</li>
<li><code>expires</code>: a <code>Date</code> object indicating the cookie's expiration date (expires at the end of session by default).</li>
<li><code>path</code>: a string indicating the path of the cookie (<code>/</code> by default).</li>
<li><code>domain</code>: a string indicating the domain of the cookie (no default).</li>
<li><code>secure</code>: a boolean indicating whether the cookie is only to be sent over HTTPS (<code>false</code> by default for HTTP, <code>true</code> by default for HTTPS).</li>
<li><code>secureProxy</code>: a boolean indicating whether the cookie is only to be sent over HTTPS (use this if you handle SSL not in your node process).</li>
<li><code>httpOnly</code>: a boolean indicating whether the cookie is only to be sent over HTTP(S), and not made available to client JavaScript (<code>true</code> by default).</li>
<li><code>signed</code>: a boolean indicating whether the cookie is to be signed (<code>true</code> by default).</li>
<li><code>overwrite</code>: a boolean indicating whether to overwrite previously set cookies of the same name (<code>true</code> by default).</li>
</ul>
<h3>req.session</h3>
<p>Represents the session for the given request.</p>
<h4>.isNew</h4>
<p>Is <code>true</code> if the session is new.</p>
<h4>.populated</h4>
<p>Determine if the session has been populated with data or is empty.</p>
<h3>req.sessionOptions</h3>
<p>Represents the session options for the current request. These options are a
shallow clone of what was provided at middleware construction and can be
altered to change cookie setting behavior on a per-request basis.</p>
<h3>Destroying a session</h3>
<p>To destroy a session simply set it to <code>null</code>:</p>
<p><code>js
req.session = null</code></p>
<h2>Example</h2>
<h3>Simple view counter example</h3>
<p>```js
var cookieSession = require('cookie-session')
var express = require('express')</p>
<p>var app = express()</p>
<p>app.set('trust proxy', 1) // trust first proxy</p>
<p>app.use(cookieSession({
  name: 'session',
  keys: ['key1', 'key2']
}))</p>
<p>app.use(function (req, res, next) {
  // Update views
  req.session.views = (req.session.views || 0) + 1</p>
<p>// Write response
  res.end(req.session.views + ' views')
})</p>
<p>app.listen(3000)
```</p>
<h2>Per-user sticky max age</h2>
<p>```js
var cookieSession = require('cookie-session')
var express = require('express')</p>
<p>var app = express()</p>
<p>app.set('trust proxy', 1) // trust first proxy</p>
<p>app.use(cookieSession({
  name: 'session',
  keys: ['key1', 'key2']
}))</p>
<p>// This allows you to set req.session.maxAge to let certain sessions
// have a different value than the default.
app.use(function (req, res, next) {
  req.sessionOptions.maxAge = req.session.maxAge || req.sessionOptions.maxAge
})</p>
<p>// ... your logic here ...
```</p>
<h2>License</h2>
<p><a href="LICENSE">MIT</a></p>