<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>CTF Writeup</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="/style.css"/>

  </head>

  <body>
    <!--Navigation Bar-->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <a class="navbar-brand" href="/index.html">Hackin7</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarText">
        <ul class="navbar-nav mr-auto">

          <li class="nav-item">
            <a class="nav-link" href="/about.html">About</a></li>
           <li><a class="nav-link" href="/achievements.html">Achievements</a></li>
           <li><a class="nav-link" href="/blog.html">Blog</a></li>
            <li><a class="nav-link" href="/links.html">CTF Writeups</a></li>
            <li><a class="nav-link" href="/all_projects.html">All Projects</a></li>
        </ul>
      </div>
    </nav>

    <div>
    
    <div class='content'>
    <link href='/css/github-css.css' rel='stylesheet' type='text/css'>
        <br>
        <a href='https://github.com/Hackin7/Programming-Crappy-Solutions/blob/master/Cyber Security/Capture the Flag Competitions/2020/Cyberthon 2020/Online Training/Forensics/BigBrother'>Original Github Link</a><br>
        <h1>BigBrother</h1>
<p>200, Forensics, 53 solves as of Solving</p>
<h2>Description</h2>
<p>This employee was so careless that he didn't realize his traffic was being sniffed. Unfortunately for him, he downloaded the flag while being watched. Can you recover the flag from the captured traffic?</p>
<h2>Useful tools:</h2>
<p>Wireshark</p>
<h2>Given</h2>
<p>data.pcap</p>
<h1>Solution</h1>
<p>Analysing the pcap file, there are 3 kinds of packets: TCP, FTP, and FTP-DATA
<img src="1.png" alt="" />
<img src="2.png" alt="" />
<img src="3.png" alt="" />
You also get to know the username <code>employee</code> and password <code>hunter2</code></p>
<p>From <a href="https://sceweb.sce.uhcl.edu/abeysekera/itec3831/labs/FILE%20SIGNATURES%20TABLE.pdf">here</a>, you know the zip file header is <code>50 4B 03 04</code>, and by googling, you get <a href="https://shankaraman.wordpress.com/tag/how-to-extract-ftp-files-from-wireshark-packet/">this website</a> which tells you how to extract ftp files from wireshark.</p>
<p>I searched for the zip file header, followed the TCP packet and saved the data as raw with .zip
<img src="4.png" alt="" />
<img src="5.png" alt="" />
<img src="6.png" alt="" /></p>
<p>Opening up the zip file, the flag.txt file is password protected. But just by guessing the password <code>hunter2</code> (because employee password), you can see the flag</p>
<p><img src="7.png" alt="" />
<img src="8.png" alt="" /></p>
<h1>Flag</h1>
<p><code>CTFSG{5N1FF_53CUR3_F1L35}</code></p>

    </div>
    
    </div>

  </body>
</html>